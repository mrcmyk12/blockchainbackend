---
name: Publish to NPM
description: Publish package to NPM index and build package locally.
author: PubNub
inputs:
  token:
    description: GitHub access token with extended permissions.
    required: false
  github-token:
    description: GitHub access token which has push permissions.
    required: false
    default: ${{ github.token }}
  npm-token:
    description: NPM REST API access token.
    required: true
  check-ownership:
    description: Whether ownership should be verified before publish.
    required: false
  npm-scope:
    description: Visibility (private or public).
    required: false
    default: public
  package-path:
    description: "Relative path to `package.json` which describe target package. File parent directory will be used as `cwd` for CLI calls."
    required: false
  actions:
    description: "What actions should be performed. Available: publish and build"
    required: false
  build-command:
    description: "CLI call which will prepare sources. Command will be executed in same folder as `package.json`"
    required: false
  build-path:
    description: Relative path to location where build command will store results.
    required: false
  artifacts-path:
    description: Relative path to location where prepared sources should be placed.
    required: false
  artifacts-filter:
    description: "Comma-separated list of file names (or path RegExp) which should be used as artifacts for upload."
    required: false
  jira-api-key:
    description: API key to access JIRA REST API.
    required: false
  last-service:
    description: Whether this is last service used in product deployment services sequence
    required: false
    default: "false"
runs:
  using: node12
  main: ../../../dist/services/npm/index.js
  post-if: failure()
  post: ../../../dist/services/helpers/service-failure.js
