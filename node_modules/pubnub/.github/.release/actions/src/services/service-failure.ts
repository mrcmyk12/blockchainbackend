import {action, getActionBooleanInput} from '../helpers/actions'
import {publishComment} from '../helpers/github'


// Check whether service is last in release sequence.
const isLastService = getActionBooleanInput('last-service', false, 'false')

/** Publish comment to PR with warning about release build failure. */
const reportBuildFailure = async () => {
  await publishComment(
    action.repository.owner,
    action.repository.repo,
    action.issue.number,
    'ðŸ›‘ Build failed. Please check release build for details ðŸ›‘'
  )
}

// Notify about release issues only when triggered by PR.
if (isLastService && !action.isRegularPush) reportBuildFailure()
